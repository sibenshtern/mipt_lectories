# Архитектура компьютеров и операционные системы (семинары) <!-- omit in toc -->

- [Некоторые основные команды Linux](#некоторые-основные-команды-linux)
- [Оболочка](#оболочка)
  - [Что это такое:](#что-это-такое)
- [Системные вызовы](#системные-вызовы)
- [Систаксис команд Unix](#систаксис-команд-unix)
  - [Команда и аргументы](#команда-и-аргументы)
  - [Перенаправление ввода-вывода](#перенаправление-ввода-вывода)
  - [Подстановки в оболочке (shell expansions)](#подстановки-в-оболочке-shell-expansions)
- [10.11.2023](#10112023)

## Некоторые основные команды Linux 

- `ls [option] [file]` - список файлов в текущей директории 
- `df -h`
- `mount /dev/sdb1 /media/tmp` - подключить диск к файловой системе (делается от администратора)
- `umount /media/tmp` - отключение диска
- `" "` - оператор начала аргумента
- `rm /tmp/my` - удалить каталог `/tmp/my`

## Оболочка

### Что это такое:

- Командный интерпретатор
- Текстовый интерфейс командной строки
- Запуск программ, выполняющих полезные действия
- Автоматизация действий в виде программ

## Системные вызовы

- Прямые точки входа пользовательских процессов в ядро  
- Выполняются в привилегированном режиме для доступа к системным данным/устройствам
- Реализованы по разному в различных ядрах
- Отображаются в вызовы функций языка `С` -> интерфейс системных вызовов -> стандартная UNIX-библиотека `libc`
- Стандарт POSIX - **P**ortable **O**perating **S**ystem **I**nterface

От библиотеки `libc` зависят все программы, выполняющиеся в Linux 

```c
#include <unistd.h> // <- int getuid()
#include <stdio.h> // <- void perror(char *)

int main() {
    int ret = getuid();
    perror("getuid result");
    return ret;
}
```

- Возвращаем значение 
  - `-1` - ошибка
  - `>= 0` - успех
- Точный код ошибка - в глобальной переменной `errno`
- При успешном завершении errno не меняется
- Расщифровка последнего кода ошибки - функция `perror(char *)` - выводит расшифровку по коду ошибки из глобальной переменной `errno` (перед этим подставляет `char *`)

## Систаксис команд Unix

### Команда и аргументы

`command arg1 arg2 ... argN`

1. **Аргументы, как опции**
  - Короткий формат:
    + `-a`
    + `-A`
    + `-bc`
  - Длинный формат:
    + `--help`
    + `--verbose`
2. **Типичное описание в документации**

`command [arg1] [arg2] arg3`

- `arg1` - необязательный аргумент `arg1`
- `arg3` - обязательный аргумент `arg3`

Короткие опции можно соединять в несколько, например не `-l -a`, а `-la`, стандарт для опций не существует.

Практически во всех командах существует опция `--help`

`man` - Manual

### Перенаправление ввода-вывода

**Вывод в файл:**
`cmd1 -a -b > out_file`
`cmd1 -c -d >> out_file`

**Считывание из файла:**
`cmd1 -e -f < in_file`

**Конвейер:**
`cmd1 -g -h | cmd2`

### Подстановки в оболочке (shell expansions)

В командной строке оболочка заменяет конструкции со спецсимволами **\***, **?**, **$**, **{}**, **[]**

1. `a*z`
   - заменяется на список имён файлов, имеющихся в текущем каталоге, соответствующих шаблону
   - подходят `az`, `abcz`, `a_z`, ...
   - `*` - любое количество любых символов
2. `a?z`
   - заменяется на список файлов имеющихся в текущем каталоге, соответствующих шаблону
   - подходят `abz`, `acz`
   - **не** подходят `az`, `abcz`
   - `?` - один любой символ
3. `a[b-d]z`
   - список файлов из текущего каталога по шаблону
   - `[]` - один любой символ из перечисленных
4. `a{bd, ed, gf}z`
   - генерирует список `abcz`, `adez`, `agfz`
   - безотносительно к файлам или текущему каталогу
5. `$var`
   - подставляет значение перменной по имени `var`
   - задать значение как `var=value` 


## 10.11.2023
lft forever preferred_lft forever
```